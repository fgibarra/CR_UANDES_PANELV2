package cl.uandes.sadmemail.apiGmailServices.model.hibernate.service;

import javax.persistence.EntityManager;
import javax.persistence.PersistenceContext;
import javax.persistence.PersistenceContextType;
import javax.transaction.Transactional;

import org.springframework.stereotype.Service;

import cl.uandes.sadmemail.apiGmailServices.model.hibernate.bean.CuentaGmailParameters;


@Service
public class ParametersServiceImpl implements ParametersService {


	@PersistenceContext(unitName = "mailParams", type = PersistenceContextType.TRANSACTION)
	private EntityManager em;
	
	public ParametersServiceImpl() {
		super();
	}

	@Override
	@Transactional(Transactional.TxType.SUPPORTS)
	public CuentaGmailParameters getParameters() {
		if (getEm() == null) {
			throw new RuntimeException(String.format("El EntityManager es %s NULO",
					em==null?"":"NO"));
		}
		try {
			getEm().getTransaction().begin();
			return em.find(CuentaGmailParameters.class, Long.valueOf(1));
		} finally {
			getEm().getTransaction().commit();
		}
	}

	public EntityManager getEm() {
		return em;
	}

	public void setEm(EntityManager em) {
		this.em = em;
	}
}
